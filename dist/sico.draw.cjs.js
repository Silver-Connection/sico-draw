"use strict";var Gauge=function(){function t(t,e){if(this.default={autoDraw:!0,backgroundColor:"#E3DBCB",backgroundShow:!0,canvasHeight:300,canvasWidth:600,centerX:"center",centerY:"center",data:void 0,deg:180,lineCap:"butt",labelInverse:!1,labelHtml:!1,labelHtmlUseCanvasSize:!1,labelCssBase:void 0,offset:180},this.defaultData={color:"#0382A0",label:void 0,labelCss:void 0,labelColor:"#727272",labelFont:"sans-serif",labelShow:!0,labelSize:20,labelStyle:"normal normal bold",size:10,value:0},this.centerXFactor=.5,this.centerYFactor=.5,this.gaugeSize=0,this.labelSize=0,null!==t&&void 0!==t){t instanceof HTMLElement?this.el=t:this.el=t[0],this.options=$.extend(!0,this.default,e),this.checkData();var i="center";"left"===this.options.centerX?(this.centerXFactor=0,i="flex-start"):"right"===this.options.centerX?(this.centerXFactor=1,i="flex-end"):this.centerXFactor=.5;var a="center";"top"===this.options.centerY?(this.centerYFactor=0,a="flex-start"):"bottom"===this.options.centerY?(this.centerYFactor=1,a="flex-end"):this.centerYFactor=.5,this.options.labelHtml&&(this.elLabels=$("<div></div)"),this.elLabels.css({position:"absolute",top:0,left:0,height:this.options.labelHtmlUseCanvasSize?this.options.canvasHeight:"100%",width:this.options.labelHtmlUseCanvasSize?this.options.canvasWidth:"100%",display:"flex","flex-direction":"column","justify-content":a,"align-items":i}),$(this.el).css({position:"relative"}).append(this.elLabels)),this.createCanvas(),this.options.autoDraw&&this.$draw()}else console.log("Could not find wrapper element")}return t.degToRands=function(t){return void 0===t?Math.PI/180:t*Math.PI/180},t.percentToRands=function(t,e){return void 0===t||void 0===e?Math.PI/180:t*e/100*Math.PI/180},t.prototype.createCanvas=function(){this.canvas=document.createElement("canvas"),this.el.appendChild(this.canvas),"object"==typeof G_vmlCanvasManager&&G_vmlCanvasManager.initElement(this.canvas),this.canvas.height=this.options.canvasHeight,this.canvas.width=this.options.canvasWidth;var t=this.canvas.getContext("2d");null!==t&&(this.context=t);var e=1;window.devicePixelRatio>1&&(e=window.devicePixelRatio,this.canvas.width=this.canvas.width*e,this.canvas.height=this.canvas.height*e,this.context.scale(e,e))},t.prototype.$draw=function(){if(this.options.backgroundShow&&this.drawBackground(),void 0!=this.options&&void 0!=this.options.data&&this.options.data.length>0){for(var t=0,e=this.options.labelHtml?0:1,i=0,a=this.options.data;i<a.length;i++){var s=a[i];this.drawGauge(s,t),t+=s.size}for(var o=0,n=this.options.labelInverse?this.options.data.reverse():this.options.data;o<n.length;o++){(s=n[o]).labelShow&&(this.options.labelHtml?this.htmlText(s):(this.drawText(s,e),e+=(s.labelSize||0)+10))}}},t.prototype.drawBackground=function(){var e=t.degToRands(this.options.deg);this.drawLine(e,this.gaugeSize,this.options.backgroundColor,0)},t.prototype.drawGauge=function(e,i){void 0===i&&(i=0);var a=t.percentToRands(e.value,this.options.deg);this.drawLine(a,e.size,e.color,i)},t.prototype.drawLine=function(e,i,a,s){void 0===s&&(s=0);var o=this.getCenterPoint(),n=this.canvas.width/2-i/2-s;this.canvas.width<this.canvas.height&&(n=this.canvas.height/2-i/2-s),this.context.beginPath(),this.context.arc(o.x,o.y,n,t.degToRands(this.options.offset),e+t.degToRands(this.options.offset),!1),this.context.strokeStyle=a,this.context.lineWidth=i,this.context.lineCap=this.options.lineCap,this.context.stroke(),this.context.closePath()},t.prototype.drawText=function(t,e){var i=this.getCenterPoint(),a=(t.labelStyle+" "+t.labelSize+"px "+t.labelFont).trim(),s="";s="function"==typeof t.label?t.label(t.value):t.label||"",this.context.textAlign=this.options.centerX||this.default.centerX,this.context.font=a;var o=i.y-e;"center"===this.options.centerY?o=i.y-e+this.labelSize/2:"top"===this.options.centerY&&(o=e+this.labelSize/2),this.context.fillStyle=t.labelColor,this.context.fillText(s,i.x,o)},t.prototype.htmlText=function(t){var e="";e="function"==typeof t.label?t.label(t.value):t.label||"";var i=this.options.labelCssBase;t.labelCss&&(i+=" "+t.labelCss),this.elLabels.append('<span class="'+i+'">'+e+"</span>")},t.prototype.getCenterPoint=function(){return{x:this.canvas.width*this.centerXFactor,y:this.canvas.height*this.centerYFactor}},t.prototype.checkData=function(){if(void 0!=this.options&&void 0!=this.options.data&&this.options.data.length>0)for(var t=0;t<this.options.data.length;t++)this.options.data[t]=$.extend(!0,{},this.defaultData,this.options.data[t]),void 0===this.options.data[t].label&&(this.options.data[t].label=this.options.data[t].value+"%"),this.gaugeSize+=this.options.data[t].size,this.labelSize+=this.options.data[t].labelSize},t}(),main={Gauge:Gauge};module.exports=main;
